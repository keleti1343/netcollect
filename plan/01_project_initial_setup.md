# Plan Step 1: Project Initial Setup

This document outlines the initial setup steps for the `fortinet_collector` module.

## 1. Directory Structure

It is recommended to create a dedicated directory for the new module to keep the codebase organized.

```
network_collector_project/
├── fortinet-collector/
│   ├── config/
│   │   └── devices.json         # Device configuration
│   ├── core/
│   │   ├── __init__.py
│   │   ├── connection.py        # Device connection logic
│   │   ├── extraction.py        # Data extraction functions/classes
│   │   └── parsing.py           # Parsing utilities (if kept separate)
│   ├── db_utils/
│   │   ├── __init__.py
│   │   └── postgres_handler.py  # PostgreSQL interaction logic
│   ├── plan/                    # Directory for these planning documents
│   │   ├── 01_project_initial_setup.md
│   │   └── ... (other plan files)
│   ├── __init__.py
│   ├── main.py                  # Main orchestration script
│   ├── requirements.txt         # Python dependencies
│   └── logs/                    # Directory for log files (optional, can be configured)
└── fortinet/                    # Existing scripts (can be archived or removed later)
    └── ...
```

**Rationale:**
-   `fortinet-collector/`: Main module directory.
-   `config/`: Stores configuration files like `devices.json`.
-   `core/`: Contains the primary logic for connecting, extracting, and parsing data.
-   `db_utils/`: Houses database-specific code.
-   `plan/`: Contains these detailed planning documents.
-   `main.py`: The entry point for running the collector.
-   `requirements.txt`: Lists project dependencies.
-   `logs/`: A common place for storing log files generated by the application.

## 2. Python Dependencies

The following Python libraries will be required. Create a `requirements.txt` file in the `fortinet_collector/` directory with the following content:

```txt
netmiko
netaddr
psycopg2-binary
# paramiko (usually a sub-dependency of netmiko, but good to be aware of)
```

**To install these dependencies, the engineer will run:**
`pip install -r requirements.txt`

## 3. Device Configuration File (`devices.json`)

A JSON file named `devices.json` will be used to store the list of Fortinet devices to connect to. This file should be placed in the `fortinet_collector/config/` directory.

**Structure:**
The file will contain a list of device objects. Each object will have the following keys:
-   `host` (string, required): The IP address or hostname of the Fortinet device.
-   `username` (string, required): The username for SSH login.
-   `password` (string, required): The password for SSH login.
-   `device_type` (string, optional, default: "fortinet"): Netmiko device type.
-   `timeout` (integer, optional, default: 100): Connection timeout in seconds.
-   `site` (string, optional): A user-defined tag for the site or location of the firewall (e.g., "gare", "datacenter_alpha"). This can be useful for context when storing data.
-   `port` (integer, optional, default: 22): SSH port.

**Example `fortinet_collector/config/devices.json`:**
```json
[
  {
    "host": "192.168.10.172",
    "username": "your_admin_user",
    "password": "your_secure_password_1",
    "device_type": "fortinet",
    "timeout": 120,
    "site": "gare_main_fw",
    "port": 22
  },
  {
    "host": "192.168.10.173",
    "username": "your_readonly_user",
    "password": "your_secure_password_2",
    "site": "gare_secondary_fw"
  }
]
```
**Security Note:** Storing passwords in plain text is not recommended for production environments. For this project, we will proceed with this method as per the current scope. Future enhancements should consider using environment variables, a secrets management tool (e.g., HashiCorp Vault, Ansible Vault), or OS keyring services.

## 4. Initial Configuration Loading Function

A Python function will be needed to load and validate the device configurations from `devices.json`. This function would typically:
-   Be located in a utility module or within `main.py` initially.
-   Open and read the `devices.json` file.
-   Parse the JSON content.
-   Perform basic validation (e.g., check for required keys like `host`, `username`, `password`).
-   Return the list of device dictionaries.
-   Handle potential errors like file not found or invalid JSON format.

This function will be called at the beginning of the `main.py` script to get the list of devices to process.